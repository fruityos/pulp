sub kmain(initJarPtr)
	local fd, buffer

	heap_init()
	global_init()

	kcls()

	kprintln("Welcome to FruityOS!")
	heap_printStats()
	kprintln("Unpacking...")
	kunpack(initJarPtr)
	ramfs_printTree(global_getRamfs())
	kprintln("Ready!")

	sys_exec("/bin/pish.fap", 0)
	return 0
end
